# stock-analyzer

## Real-time stock data processing system.

Please notice that the three time series are generated by random data during the testing stage, since the stock market is not open during the weekend.
![Image](https://github.com/brucexiejiaming/stock-analyzer/blob/master/demo.gif?raw=true)

## Architecture
![Image](https://github.com/brucexiejiaming/stock-analyzer/blob/master/architecture.jpg?raw=true)




####Docker Setup
Have the following containers to set up before running the project.
#####Kafka
~~~~
docker run -d -p 9092:9092 -e KAFKA_ADVERTISED_HOST_NAME=`docker-machine ip bigdata` -e KAFKA_ADVERTISED_PORT=9092 --name kafka --link zookeeper:zookeeper confluent/kafka
~~~~

#####Zookeeper
~~~~
docker run -d -p 2181:2181 -p 2888:2888 -p 3888:3888 --name zookeeper confluent/zookeeper
~~~~

#####Cassandra
~~~~
docker run -d -p 7199:7199 -p 9042:9042 -p 9160:9160 -p 7001:7001 --name cassandra cassandra:3.7
~~~~

#####Redis
~~~~
docker run -d -p 6379:6379 --name redis redis:alpine
~~~~


~~~~
eval $(docker-machine env bigdata)
~~~~


Check the ip for the "bigdata" VM: 
~~~~
docker-machine ip bigdata
~~~~

Assume that the ip is 192.168.99.100.
Use the following command lines to set up different parts:

####Kafka
~~~~
python simple-data-producer.py AAPL stock-analyzer 192.168.99.100:9092
~~~~

####Cassandra
~~~~
python data-storage.py stock-analyzer 192.168.99.100:9092 stock stock 192.168.99.100
~~~~

####Spark
~~~~
spark-submit --jars spark-streaming-kafka-0-8-assembly_2.11-2.0.0.jar stream-processing.py stock-analyzer averagePrice 192.168.99.100:9092
~~~~

####Redis
~~~~
python redis-publisher.py averagePrice 192.168.99.100:9092 averagePrice 192.168.99.100 6379
~~~~

####Nodejs
~~~~
node index.js --redis_port 6379 --redis_host 192.168.99.100 --subscribe_topic averagePrice --port 3000
~~~~
